---
import { Icon } from 'astro-icon';

export async function data() {
	// Fetch your recent GitHub projects sorted by last recent commit
	const response = await fetch(
		'https://api.github.com/users/tverderesi/repos?sort=pushed&direction=desc&per_page=10&offset=0'
	);
	const projects = await response.json();

	return {
		projects,
	};
}

const { projects } = await data();
---

<div class="grid gap-6 row-gap-5 md:grid-cols-2 lg:grid-cols-4 -mb-6">
	{
		projects.map((project) => (
			<article class="mb-6 transition">
				<div class="relative h-0 pb-[56.25%] lg:h-64 overflow-hidden bg-gray-400 dark:bg-slate-700 rounded shadow-lg mb-6">
					<h3 class="mb-2 text-xl font-bold leading-snug sm:text-2xl font-heading">
						<a
							href={project.html_url}
							class="hover:text-primary-600 underline underline-offset-4 decoration-1 decoration-dotted transition ease-in duration-200"
						>
							{project.name}
						</a>
					</h3>
					<div class="flex justify-between items-center">
						<div class="flex items-center">
							<Icon name="ic:code-commit" class="w-5 h-5 mr-1 text-primary-500" />
							<span class="text-sm text-gray-600 dark:text-gray-400">{project.commits}</span>
						</div>
						<div class="flex items-center">
							<Icon name="ic:star" class="w-5 h-5 mr-1 text-yellow-500" />
							<span class="text-sm text-gray-600 dark:text-gray-400">{project.stars}</span>
						</div>
						<div class="flex items-center">
							<Icon name="ic:fork" class="w-5 h-5 mr-1 text-gray-500" />
							<span class="text-sm text-gray-600 dark:text-gray-400">{project.forks}</span>
						</div>
					</div>
				</div>
			</article>
		))
	}
</div>
